# CTF Box Solving Manual

- [Recon Tools and Commands](#recon-tools-and-commands)
- [Linux Priviledge Escalation](#linux-priviledge-escalation)
- [Windows Priviledge Escalation](#windows-priviledge-escalation)

## Recon Tools and Commands

- Autorecon
   - https://github.com/21y4d/nmapAutomator
   - https://github.com/Tib3rius/AutoRecon/
- naabu + nmap
   - Basic `naabu -nmap-cli 'nmap -Pn -T5 -A -oN nmapbasic.txt' -host domain.com`
   - Basic All port `naabu -p 0-65535 -nmap-cli 'nmap -Pn -T5 -A -oN nmapallport.txt' -host domain.com`
   - All port with vuln scripts `naabu -p 0-65535 -nmap-cli 'nmap --script vuln -Pn -T5 -A -oN nmapvuln.txt' -host domain.com | tee -a nmap.txt`
   - Windows AD Specific `nmap -p 53,88,135,139,389,445,464,593,636,3268,3269,3389,5985,9389,49152-65535 --script smb-enum-shares,smb-enum-users,ldap-rootdse,ldap-search,krb5-enum-users,smb-os-discovery,smb-vuln-ms17-010,smb-enum-domains,smb-enum-sessions,smb-enum-processes,smb2-security-mode,smb2-capabilities,smb-system-info,msrpc-enum,smb-brute,rdp-enum-encryption,rdp-vuln-ms12-020,rdp-ntlm-info,ssl-cert,ssl-enum-ciphers,smb-protocols,ms-sql-info,smb-vuln-regsvc-dos -oN nmapAD.txt <target> `

- Wordlist generator
   `cewl http://domain.tld/ | grep -v CeWL > custom-wordlist.txt`
- Subdomain Enumeration
   1. Gobuster ```gobuster vhost -u http://monitorsthree.htb --append-domain -w /opt/wordlist/SecLists/Discovery/DNS/subdomains-top1million-5000.txt -r```
   2. ffuf ```ffuf -w /opt/wordlist/SecLists/Discovery/DNS/subdomains-top1million-110000.txt:FUZZ -fw 18 -mc all -ac -u http://domain.tld -H 'Host: FUZZ.domain.tld'```
- Directory Busting
   1. Recursive directory busting `ffuf -w /opt/wordlist/SecLists/Discovery/Web-Content/directory-list-lowercase-
2.3-big.txt -ic -recursion -recursion-depth 3 -u https://target.com/FUZZ/`
   2. Directory`ffuf -w /opt/wordlist/SecLists/Discovery/Web-Content/raft-large-directories.txt -u https://target.com/FUZZ/`
   3. Files `ffuf -w /opt/wordlist/SecLists/Discovery/Web-Content/raft-large-files.txt -u https://target.com/FUZZ/`
- Parameter Fuzzing
   1. Paramter ``` ```
- BruteForce
- Check outdated or vulnerable version for any service or software using exploitdb and google
- Default Crecdentials, Check any software or service is using default credential or easy to crack username password


## Linux Priviledge Escalation

1. SUID Binaries
- **Find SUID Files**: `find / -perm -4000 2>/dev/null`
- **Exploits**: Use GTFOBins for known SUID binary exploits.

2. sudo -l (Check Sudo Privileges)
- **List Privileges**: `sudo -l`
- **Exploits**: Look for `NOPASSWD` or exploitable commands (e.g., `vim`, `find`).

3. Cron Jobs
- **View Cron Jobs**: `cat /etc/crontab`, `ls -la /etc/cron.d/`
- **Exploits**: Writable cron scripts or wildcard abuse.

4. Writable /etc/passwd
- **Exploit**: Add new root user using password hash from `openssl passwd -1`.

5. SSH Keys
- **Find Keys**: `find / -name "*.pem" 2>/dev/null`
- **Exploit**: Use private key for SSH if no passphrase.

6. Kernel Exploits
- **Check Kernel**: `uname -r`
- **Exploit**: Search for exploits by kernel version on Exploit-DB.

7. PATH Variable Manipulation
- **Exploit**: Modify `PATH` and place malicious script in writable directory.

8. NFS Root Squashing
- **Check**: Look for `no_root_squash` in `/etc/exports`
- **Exploit**: Mount and access with root on NFS share.

9. World-Writable Files
- **Find**: `find / -writable -type d 2>/dev/null`
- **Exploit**: Overwrite world-writable scripts or binaries.

10. LD_PRELOAD and LD_LIBRARY_PATH
- **Exploit**: Inject code with custom library.
  ```bash
  gcc -fPIC -shared -o shell.so shell.c -nostartfiles
  LD_PRELOAD=./shell.so <vulnerable_program>
  
11. Docker Privilege Escalation
- **Exploit**: Mount root filesystem and escape container:
  ```bash
  docker run -v /:/mnt --rm -it alpine chroot /mnt sh
  ```
12. Password and Credential Files
- **Find Sensitive Files**:
  ```bash
  find / -name "*.bak" 2>/dev/null
  find / -name "*.old" 2>/dev/null
  grep -i "password" /path/to/directory
  ```
  




## Windows Priviledge Escalation






