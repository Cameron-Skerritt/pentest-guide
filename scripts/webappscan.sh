#! /bin/bash

#if [ "$EUID" -ne 0 ]
#  then echo "Please run as root"
#  exit
#fi


if [[ $# -eq 0 ]] ; then
    echo "[-] Domain not supplied [-]"
    echo "[+] Example: >_ $0 domain.com [+]"
    exit 1
fi

if [[ $# > 1 ]] ; then
	echo "[-] Unnecessary Arguments [-]"
    echo "[+] Example: >_ $0 domain.com [+]"
	exit 1
fi


regex='^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$'
if ! [[ $1 =~ $regex ]]; then
	echo "[-] Argument is not a domain. [-]"
    echo "[+] Example: >_ $0 domain.com [+]"
	exit 1
fi

echo "[+]------ Scanning After SubAuto Script ------[+]";
echo "[+]------ Web App Scanner ------[+]";
echo "[+]------ Zishan Ahamed Thandar ------[+]";



echo "[+] Running Wapiti [+]"
(cat "$1httpsubs.txt" | while read url; do wapiti -u $url -t 4 -o temp_scan.json -f json > /dev/null 2>&1 && jq -e '.vulnerabilities | length > 0' temp_scan.json > /dev/null && cat temp_scan.json >> "${1}wapiti_scan_results.json"; rm -f temp_scan.json; done)






echo "[+] Web Scan Done [+]"

