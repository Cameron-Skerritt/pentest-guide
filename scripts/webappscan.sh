#! /bin/bash

#if [ "$EUID" -ne 0 ]
#  then echo "Please run as root"
#  exit
#fi


if [[ $# -eq 0 ]] ; then
    echo "[-] Domain not supplied [-]"
    echo "[+] Example: >_ $0 domain.com [+]"
    exit 1
fi

if [[ $# > 1 ]] ; then
	echo "[-] Unnecessary Arguments [-]"
    echo "[+] Example: >_ $0 domain.com [+]"
	exit 1
fi


regex='^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$'
if ! [[ $1 =~ $regex ]]; then
	echo "[-] Argument is not a domain. [-]"
    echo "[+] Example: >_ $0 domain.com [+]"
	exit 1
fi

echo "[+]------ Scanning After SubAuto Script ------[+]";
echo "[+]------ Web App Scanner ------[+]";
echo "[+]------ Zishan Ahamed Thandar ------[+]";



echo "[+] Running Wapiti [+]"
(cat $1httpsubs.txt | while read url; do wapiti "$url" --timeout 4 --no-banner -o temp_scan.json -f json && jq -e '.vulnerabilities | length > 0' $1temp_scan.json > /dev/null && cat $1temp_scan.json >> $1wapiti_scan_results.json; done)







